import{Q as t,r as e,g as a,G as s,h as i,R as l,T as o,o as c,d as n,a as d,w as u,b as r,F as y,e as h,c as p,t as C,l as f,x as m,k as L,U as g,V as _,W as w,s as v,X as k,m as B,I as T,i as b,L as I,C as S,Y as N}from"./index.a522f241.js";import{_ as x}from"./plugin-vue_export-helper.21dcd24c.js";const G="定位中",H="定位失败，请重试",U="无法获取当前城市信息，请手动选择",E="WPEBZ-BPM6O-RH2WA-S2MWT-LQ6JJ-OYBZH";var V={getLocationUrl:(t,e)=>`https://apis.map.qq.com/ws/geocoder/v1/?location=${t},${e}&key=${E}`,safeGet:(t,e)=>t.reduce(((t,e)=>t&&t[e]?t[e]:null),e),isNotEmpty:t=>Array.isArray(t)&&t.length>0,isChinese:t=>/^[\u4e00-\u9fa5]+$/.test(t),getSlicedName:(t,e,a)=>t[e]&&t[e].slice(0,a),onFail:t=>{console.log(t)}};const{isNotEmpty:W,isChinese:$,getSlicedName:A}=V,F=[{city:"无匹配城市",code:"000"}];class j{constructor(t){this.content=t}associativeSearch(){let t=this.searchList(this.content);return this.showList(t)}searchList(e){let a;return t().filter((t=>(a=this.getTargetCity(e,t),a&&a==e)))}getTargetCity(t,e){if($(t)){return A(e,"city",t.length)}}showList(t){return W(t)?t.map((t=>({city:t.city,cityCode:t.cityCode}))):F}}const{isNotEmpty:q,safeGet:z,getLocationUrl:D,getCountyListUrl:J,onFail:K}=V;var M=x({setup(){const t=e({data:[]}),c=a(0),n=e({data:[]}),d=s(g),u=e(d),r=a(!1),y=a(""),h=e({code:0,seledCity:G}),p=a(""),C=e({data:[]}),f=a(""),m=()=>{_({type:"wgs84",geocode:!0,success:function(t){(t=>{const{latitude:e,longitude:a}=t;S({url:D(e,a),success:t=>{const e=N(t.data.result.ad_info.city);e?(h.seledCity=e[0].city,h.code=e[0].cityCode):h.seledCity=U}})})(t)},fail:function(){K(H)}})};i((()=>{const e=l();let a;o({success:t=>{a=t}});const s=a.windowHeight,i=w.map((t=>({name:t})));c.value=s,t.data=i,n.data=e,m()}));return{bindBlur:t=>{p.value="",C.data=[]},bindKeyInput:t=>{let e=t.detail.value.trim();p.value=e,p||(C.data=[]),(t=>{let e=new j(t).associativeSearch();C.data=e})(p.value)},chooseCity:(t,e)=>{C.data=[],v.commit("updateCityData",{code:t,seledCity:e}),k({delta:1})},toastShowLetter:f,reGetLocation:()=>{"无法获取当前城市信息，请手动选择"!==h.seledCity?(v.commit("updateCityData",h),k({delta:1})):B({content:"请手动选择城市",showCancel:!1})},sideBarLetterList:t,touchSideBarLetter:t=>{f.value=t,r.value=!0,y.value=t,setTimeout((()=>{r.value=!1}),500)},windowHeight:c,cityList:n,hotCityList:u,showChosenLetterToast:r,scrollTopId:y,city:h,inputName:p,completeList:C}}},[["render",function(t,e,a,s,i,l){const o=T,g=b,_=I;return c(),n(y,null,[d(g,{class:"input"},{default:u((()=>[d(o,{onInput:s.bindKeyInput,onBlur:s.bindBlur,"placeholder-style":"font-size: 30rpx",placeholder:"输入城市名查询",modelValue:s.inputName,"onUpdate:modelValue":e[0]||(e[0]=t=>s.inputName=t)},null,8,["onInput","onBlur","modelValue"])])),_:1}),d(g,{class:"container-inner"},{default:u((()=>[d(g,{class:"side-bar-letter-list touch-class"},{default:u((()=>[d(g,{class:"side-bar-hot-city"},{default:u((()=>[d(g,{style:{"margin-top":"0"}},{default:u((()=>[r("热门")])),_:1}),d(g,{style:{"margin-top":"0"}},{default:u((()=>[r("城市")])),_:1}),(c(!0),n(y,null,h(s.sideBarLetterList.data,((t,e)=>(c(),p(g,{style:{color:"#8bc34a","font-size":"20rpx"},key:e,onTouchend:e=>s.touchSideBarLetter(t.name)},{default:u((()=>[r(C(t.name),1)])),_:2},1032,["onTouchend"])))),128))])),_:1})])),_:1}),d(g,{class:"container"},{default:u((()=>[s.showChosenLetterToast?(c(),p(g,{key:0,class:"show-chosen-letter"},{default:u((()=>[r(C(s.toastShowLetter),1)])),_:1})):f("",!0),d(_,{"scroll-y":"true","scroll-into-view":s.scrollTopId,style:m({height:s.windowHeight+"px"})},{default:u((()=>[L("ul",{class:"ul"},[(c(!0),n(y,null,h(s.completeList.data,(t=>(c(),n("li",{key:t.cityCode,onClick:e=>s.chooseCity(t.cityCode,t.city),class:"li"},C(t.city),9,["onClick"])))),128))]),d(g,{class:"city-picker"},{default:u((()=>[d(g,{class:"current-city",onClick:e[1]||(e[1]=t=>s.reGetLocation())},{default:u((()=>[r(C(s.city.seledCity),1)])),_:1}),d(g,{class:"hotcity-common"},{default:u((()=>[r("热门城市")])),_:1}),d(g,{class:"hot-city"},{default:u((()=>[(c(!0),n(y,null,h(s.hotCityList,(t=>(c(),p(g,{key:t.cityCode},{default:u((()=>[d(g,{class:"weui-grid",onClick:e=>s.chooseCity(t.cityCode,t.city)},{default:u((()=>[d(g,{class:"weui-grid-label"},{default:u((()=>[r(C(t.city),1)])),_:2},1024)])),_:2},1032,["onClick"])])),_:2},1024)))),128))])),_:1})])),_:1}),(c(!0),n(y,null,h(s.cityList.data,(t=>(c(),p(g,{class:"selection",key:t.initial},{default:u((()=>[d(g,{class:"item-letter",id:t.initial},{default:u((()=>[r(C(t.initial),1)])),_:2},1032,["id"]),(c(!0),n(y,null,h(t.cityInfo,(t=>(c(),p(g,{class:"item-city",key:t.cityCode,onClick:e=>s.chooseCity(t.cityCode,t.city)},{default:u((()=>[r(C(t.city),1)])),_:2},1032,["onClick"])))),128))])),_:2},1024)))),128))])),_:1},8,["scroll-into-view","style"])])),_:1})])),_:1})],64)}],["__scopeId","data-v-0cd3c2db"]]);export{M as default};
